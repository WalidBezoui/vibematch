{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User Profile",
      "type": "object",
      "description": "Represents a user's public and private profile information.",
      "properties": {
        "uid": { "type": "string", "description": "The user's unique ID from Firebase Authentication." },
        "email": { "type": "string", "format": "email" },
        "name": { "type": "string", "description": "User's full name (for creators) or company name (for brands)." },
        "role": { "type": "string", "enum": ["brand", "creator"] },
        "createdAt": { "type": "string", "format": "date-time" },
        "photoURL": { "type": "string", "format": "uri", "description": "URL to the user's profile picture or brand logo."}
      },
      "required": ["uid", "email", "name", "role", "createdAt"]
    },
    "CreatorProfile": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Creator Profile",
        "type": "object",
        "description": "Extended profile information for a Creator.",
        "allOf": [{ "$ref": "#/entities/UserProfile" }],
        "properties": {
            "displayName": { "type": "string", "description": "First name or public nickname."},
            "location": { "type": "string" },
            "bio": { "type": "string", "maxLength": 500 },
            "tags": { "type": "array", "items": { "type": "string" } },
            "adminBadge": { "type": "string", "enum": ["NONE", "VERIFIED", "RISING_STAR", "TOP_RATED"] },
            "initialTrustScore": { "type": "integer", "minimum": 0, "maximum": 100 }
        }
    },
    "BrandProfile": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Brand Profile",
        "type": "object",
        "description": "Extended profile information for a Brand.",
        "allOf": [{ "$ref": "#/entities/UserProfile" }],
        "properties": {
            "companyName": { "type": "string" },
            "logoUrl": { "type": "string", "format": "uri" },
            "industry": { "type": "string" },
            "website": { "type": "string", "format": "uri" },
            "description": { "type": "string" },
            "isPaymentVerified": { "type": "boolean", "default": false }
        }
    },
    "PortfolioProject": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Portfolio Project",
        "type": "object",
        "description": "A single project in a creator's portfolio.",
        "properties": {
            "title": { "type": "string" },
            "date": { "type": "string", "format": "date" },
            "description": { "type": "string" },
            "mediaUrl": { "type": "string", "format": "uri" }
        },
        "required": ["title", "date", "mediaUrl"]
    },
    "Campaign": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Campaign",
      "type": "object",
      "description": "Represents a collaboration contract between a Brand and one or more Creators.",
      "properties": {
        "title": { "type": "string" },
        "campaignBrief": { "type": "string" },
        "deliverables": { "type": "array", "items": { "type": "string" } },
        "budget": { "type": "number", "description": "The budget allocated per creator." },
        "numberOfCreators": { "type": "integer", "minimum": 1, "default": 1, "description": "The total number of creators to hire for the campaign." },
        "tags": { "type": "array", "items": { "type": "string" } },
        "brandId": { "type": "string" },
        "creatorIds": { "type": "array", "items": { "type": "string" }, "description": "An array of creator UIDs who have been accepted into the campaign." },
        "status": {
          "type": "string",
          "enum": [
            "OPEN_FOR_APPLICATIONS",
            "PENDING_SELECTION",
            "LAST_ACTIVITY_CHECK",
            "OFFER_PENDING",
            "PENDING_CREATOR_ACCEPTANCE",
            "PENDING_PAYMENT",
            "IN_PROGRESS",
            "DELIVERED",
            "COMPLETED",
            "REJECTED_BY_CREATOR"
          ]
        },
        "createdAt": { "type": "string", "format": "date-time" },
        "updatedAt": { "type": "string", "format": "date-time" }
      },
      "required": ["title", "campaignBrief", "deliverables", "budget", "numberOfCreators", "brandId", "status", "createdAt", "updatedAt"]
    },
    "CampaignApplication": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Campaign Application",
      "type": "object",
      "description": "Represents a Creator's application to a specific campaign.",
      "properties": {
        "campaignId": { "type": "string" },
        "creatorId": { "type": "string" },
        "brandId": { "type": "string" },
        "coverLetter": { "type": "string" },
        "bidAmount": { "type": "number" },
        "campaignBudgetSnapshot": { "type": "number" },
        "status": { 
            "type": "string", 
            "enum": [
                "APPLIED",
                "INVITED",
                "NEGOTIATING",
                "OFFER_ACCEPTED",
                "ACTIVE_CONTRACT",
                "SUBMITTED",
                "COMPLETED",
                "CANCELLED",
                "REJECTED",
                "EXPIRED"
            ] 
        },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["campaignId", "creatorId", "brandId", "coverLetter", "bidAmount", "status", "createdAt"]
    },
    "Conversation": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Conversation",
        "type": "object",
        "description": "A conversation thread related to a campaign application.",
        "properties": {
            "campaign_id": { "type": "string" },
            "application_id": { "type": "string" },
            "brand_id": { "type": "string" },
            "creator_id": { "type": "string" },
            "status": { "type": "string", "enum": ["NEGOTIATION", "OFFER_ACCEPTED", "ACTIVE", "REVIEW", "COMPLETED", "CANCELLED"] },
            "agreed_budget": { "type": "number" },
            "last_offer_by": { "type": "string", "description": "The UID of the user who made the last offer."},
            "is_funded": { "type": "boolean" },
            "lastMessage": { "type": "string" },
            "updatedAt": { "type": "string", "format": "date-time" }
        },
        "required": ["campaign_id", "application_id", "brand_id", "creator_id", "status", "is_funded"]
    },
    "Message": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Message",
        "type": "object",
        "description": "A single message within a conversation.",
        "properties": {
            "conversation_id": { "type": "string" },
            "sender_id": { "type": "string" },
            "type": { "type": "string", "enum": ["TEXT", "SYSTEM_OFFER", "SYSTEM_ESCROW", "SYSTEM_DELIVERY", "SYSTEM_EVENT"] },
            "content": { "type": "string" },
            "metadata": {
                "type": "object",
                "properties": {
                    "offer_amount": { "type": "number" },
                    "offer_status": { "type": "string", "enum": ["PENDING", "ACCEPTED", "REJECTED", "SUPERSEDED"] }
                }
            },
            "timestamp": { "type": "string", "format": "date-time" }
        },
        "required": ["conversation_id", "sender_id", "type", "timestamp"]
    }
  },
  "auth": {
    "providers": ["password", "anonymous"]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/entities/UserProfile"
          },
          "description": "Stores profile information for both Brands and Creators. The 'role' field determines which specific profile type applies.",
          "params": [{ "name": "userId", "description": "The unique ID of the user." }]
        },
        "subcollections": [
            {
                "path": "/users/{userId}/portfolio/{projectId}",
                "definition": {
                    "entityName": "PortfolioProject",
                    "schema": { "$ref": "#/entities/PortfolioProject" },
                    "description": "Stores a creator's portfolio projects.",
                    "params": [
                        { "name": "userId", "description": "The unique ID of the creator."},
                        { "name": "projectId", "description": "The unique ID for the portfolio project."}
                    ]
                }
            }
        ]
      },
      {
        "path": "/campaigns/{campaignId}",
        "definition": {
          "entityName": "Campaign",
          "schema": { "$ref": "#/entities/Campaign" },
          "description": "Stores all campaign contracts between brands and creators.",
          "params": [{ "name": "campaignId", "description": "The unique ID for the campaign." }]
        },
        "subcollections": [
          {
            "path": "/campaigns/{campaignId}/applications/{applicationId}",
            "definition": {
              "entityName": "CampaignApplication",
              "schema": { "$ref": "#/entities/CampaignApplication" },
              "description": "Stores applications from creators for a specific campaign.",
              "params": [
                { "name": "campaignId", "description": "The unique ID of the parent campaign." },
                { "name": "applicationId", "description": "The unique ID for the application." }
              ]
            }
          }
        ]
      },
      {
        "path": "/conversations/{conversationId}",
        "definition": {
          "entityName": "Conversation",
          "schema": { "$ref": "#/entities/Conversation" },
          "description": "A conversation thread related to a campaign application.",
          "params": [{ "name": "conversationId", "description": "The unique ID for the conversation." }]
        },
        "subcollections": [
            {
                "path": "/conversations/{conversationId}/messages/{messageId}",
                "definition": {
                    "entityName": "Message",
                    "schema": { "$ref": "#/entities/Message" },
                    "description": "A single message within a conversation.",
                    "params": [
                        { "name": "conversationId", "description": "The unique ID of the parent conversation."},
                        { "name": "messageId", "description": "The unique ID for the message."}
                    ]
                }
            }
        ]
      }
    ]
  }
}
